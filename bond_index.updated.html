<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Bond Valuation Calculator | CFA Institute</title>
<meta content="Interactive bond valuation calculator demonstrating present value calculations for coupon bonds" name="description"/>
<!-- Styles -->

<!-- Chart.js for visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<link href="core.css" rel="stylesheet"/><link href="bond_overrides.css" rel="stylesheet"/></head>
<body>
<div class="container">
<!-- Skip Links for Accessibility -->
<nav aria-label="Skip links" role="navigation">
<a class="skip-link" href="#calculator">Skip to calculator</a>
<a class="skip-link" href="#visualizer">Skip to data table</a>
</nav>
<main class="content">
<!-- Card 1: Equation -->
<section class="card" id="equation-card">
<h4 class="card-title">Bond Valuation Equation</h4>
<p class="equation-intro">
    Equation 6 shows the price of a coupon bond expressed as:
  </p>
<p class="sr-only" id="equation-description">
  Equation showing the price of a coupon bond as the sum of the present value of all coupon payments
  and the face value, discounted at the yield to maturity.
</p>
<div aria-describedby="equation-description" aria-label="Bond valuation equation" class="equation-container" role="region" tabindex="0">
<!-- MathML version -->
<div id="mathml-equation">
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
<mrow>
<msub>
<mi mathcolor="#b95b1d">PV</mi>
<mtext mathcolor="#b95b1d">coupon bond</mtext>
</msub>
<mo>=</mo>
<mfrac linethickness="1.2px">
<mi mathcolor="#3c6ae5" mathvariant="bold">PMT</mi>
<mrow class="denominator-r">
<mi mathcolor="#7a46ff">r</mi>
</mrow>
</mfrac>
<mo>×</mo>
<mrow>
<mo>[</mo>
<mn>1</mn>
<mo>-</mo>
<mfrac>
<mn>1</mn>
<msup>
<mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi mathcolor="#7a46ff">r</mi><mo>)</mo></mrow>
<mi>T</mi>
</msup>
</mfrac>
<mo>]</mo>
</mrow>
<mo>+</mo>
<mfrac>
<mi mathcolor="#0079a6" mathvariant="bold">FV</mi>
<msup>
<mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi mathcolor="#7a46ff">r</mi><mo>)</mo></mrow>
<mi>T</mi>
</msup>
</mfrac>
</mrow>
</math>
</div>
<!-- HTML fallback -->
<div hidden="" id="html-equation">
<span class="bold" style="color:#b95b1d;">PV<sub>coupon bond</sub></span> =
      <span style="color:#3c6ae5;">PMT</span>/<span style="color:#7a46ff;">r</span>
      × [1 - 1/(1 + <span style="color:#7a46ff;">r</span>)<sup>T</sup>] +
      <span style="color:#0079a6;">FV</span>/(1 + <span style="color:#7a46ff;">r</span>)<sup>T</sup>
</div>
</div>
</section>
<!-- Cards 2 & 3: Results and Visualizer (side by side on desktop) -->
<div class="grid-container">
<!-- Card 2: Results & Analysis -->
<div class="grid-item-left">
<section class="card" id="results-card">
<h4 class="card-title">Results and Analysis</h4>
<div class="card-content">
<div id="results-content">
<!-- Populated by JavaScript -->
</div>
</div>
</section>
</div>
<!-- Card 3: Visualizer -->
<div class="grid-item-right">
<section class="card" id="visualizer" tabindex="-1">
<h4 class="card-title">Bond Cash Flows: Semi-annual Payment Frequency</h4>
<div class="card-content">
<!-- View toggle buttons -->
<div class="view-controls">
<div class="legend" id="chart-legend">
<span class="legend-item">
<span class="legend-color" style="background-color: #b95b1d; border: 1px solid #333;"></span>
                    Initial purchase
                  </span>
<span class="legend-item">
<span class="legend-color" style="background-color: #3c6ae5; border: 1px solid #333;"></span>
                    Coupon payment
                  </span>
<span class="legend-item">
<span class="legend-color" style="background-color: #0079a6; border: 1px solid #333;"></span>
                    Principal repayment
                  </span>
</div>
<div aria-label="View mode - switch between chart and table" class="button-group" role="group">
<button aria-pressed="true" class="toggle-btn active" id="chart-view-btn">
      Show Chart
    </button>
<button aria-pressed="false" class="toggle-btn" id="table-view-btn">
      Show Table
    </button>
</div>
</div>
<!-- Screen reader announcement for view changes -->
<div aria-atomic="true" aria-live="polite" class="sr-only" id="view-announcement"></div>
<!-- Hidden chart description -->
<div class="sr-only" id="bond-chart-desc">
<h5 id="bond-chart-title">Bond cash flows over time</h5>
<p>
    This chart displays the complete cash flow timeline for a bond investment. 
    At period 0, the initial purchase price is shown as a negative cash flow (money paid out). 
    Then, at each semi-annual period, the bond pays a coupon payment shown in blue. 
    At the final maturity date, both the last coupon payment and the principal repayment 
    (shown in teal) are received. The stacked bars show how coupon and principal payments 
    combine at each period. Use the arrow keys to navigate between data points and hear 
    the specific values for each period.
  </p>
</div>
<!-- Chart container (add tabindex="-1" for programmatic focus) -->
<div aria-describedby="bond-chart-desc" aria-labelledby="bond-chart-title" class="chart-wrapper" id="chart-container" role="region" tabindex="-1"> <!-- Added tabindex="-1" -->
<canvas id="bond-chart"></canvas>
</div>
<!-- Table container (add role, aria-label, and tabindex="-1") -->
<div aria-label="Bond cash flow table" class="table-wrapper" id="table-container" role="region" style="display: none;" tabindex="-1"> <!-- Added tabindex="-1" -->
<table class="data-table" id="cash-flow-table"> <!-- Removed tabindex="0" -->
<!-- Populated by JavaScript -->
</table>
<p class="table-note" id="table-note">
    Note: Values in parentheses indicate negative cash flows (outflows).
  </p>
</div>
</div>
</section>
</div>
</div>
<!-- Card 4: Calculator -->
<section class="card" id="calculator" tabindex="-1">
<h4 class="card-title">Bond Cash Flow Calculator</h4>
<div class="card-content">
<!-- Static info row -->
<div class="info-box">
<div class="info-item">
<span class="info-label">Face value:</span>
<span class="info-value">$100.00</span>
</div>
<div class="info-item">
<span class="info-label">Payment frequency:</span>
<span class="info-value">Semi-annual</span>
</div>
</div>
<!-- Required fields indicator -->
<!-- Input controls -->
<div class="input-section">
<p class="sr-only" id="inputHelp">
              Enter values and the calculator updates results and the chart automatically.
            </p>
<div class="input-group-inline">
<div class="input-inline">
<label class="input-label-inline" for="coupon-rate">
    Coupon rate (0-10):
  </label>
<div class="input-with-suffix-inline">
<input class="input-field-inline" id="coupon-rate" max="10" min="0" step="0.1" type="number" value="8.6"/>
<span class="input-suffix-inline">%</span>
</div>
</div>
<div class="input-inline">
<label class="input-label-inline" for="ytm">
    Yield-to-maturity (0-10):
  </label>
<div class="input-with-suffix-inline">
<input class="input-field-inline" id="ytm" max="10" min="0" step="0.1" type="number" value="6.5"/>
<span class="input-suffix-inline">%</span>
</div>
</div>
<div class="input-inline">
<label class="input-label-inline" for="years">
    Years-to-maturity (1-5):
  </label>
<div class="input-with-suffix-inline">
<input class="input-field-inline" id="years" max="5" min="1" step="0.5" type="number" value="5"/>
<span class="input-suffix-inline"> </span>
</div>
</div>
</div>
<!-- Validation summary -->
<div class="validation-summary" id="validation-summary" role="alert" style="display: none;">
<div class="validation-title">Please correct the following:</div>
<ul id="validation-list"></ul>
</div>
</div>
</div>
</section>
</main>
</div>
<!-- JavaScript Modules -->
<script src="calculator.js" type="module"></script>
<script>
  // Simple MathML support check
  const supportsMathML = CSS.supports('math-style: normal');

  if (!supportsMathML) {
    // Hide MathML, show fallback
    const mathml = document.getElementById('mathml-equation');
    const fallback = document.getElementById('html-equation');
    if (mathml && fallback) {
      mathml.hidden = true;
      fallback.hidden = false;
    }
  }
</script>
</body>
</html>